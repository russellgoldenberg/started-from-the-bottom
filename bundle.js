!function(t){function e(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return t[r].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e){"use strict";var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};!function(){function t(t,e){return"translate("+t+","+e+")"}function e(t){return t.map(function(t,e){return n({},t,{seasonFormatted:tt.parse(t.seasonYear),id:e})})}function r(t){return t.length%2===1?t[t.length-1]:null}function a(t){var e=t.values.map(function(t,e){return t.start||t.stop?e:-1}).filter(function(t){return t>-1}),n=e.length,r=2*Math.floor(n/2),a=e.slice(0,r),o=a.map(function(t,e){var n=e%2?t-a[e-1]:-1;return n}).filter(function(t){return t>0}).reduce(function(t,e){return t.concat(e)},[]);return{indices:e,completed:o}}function o(t){var e=0;return t.map(function(t){var n=t.bottom,r=t.top;return n&&!e?(t.start=!0,t.stretch=!0,e+=1):r&&e&&(t.stop=!0,t.stretch=!0,t.stopCount=e,e=0),e&&(t.stretch=!0,e+=1),t})}function s(t){var e=t.stretches.indices,n=e.length,r=2*Math.floor(n/2),a=e.slice(0,r),o=a.map(function(e,n){var r=e+1,o=a[n-1];return n%2?t.values.slice(o,r):null}).filter(function(t){return t});return o}function i(t){var e=t-U;return 2>e?'was <strong class="top">quicker</strong> than':e>2?'took <strong class="bottom">longer</strong> than':"was about"}function c(t){switch(t){case"top-and-bottom":return{all:[],wins:z.filter(function(t){return t.wins}),stretches:[]};case"warriors":var e=D.filter(function(t){return"GSW"===t.key});return{all:e,wins:e[0].values.filter(function(t){return t.wins}),stretches:[]};case"stretch-single":var n=D.filter(function(t){return t.key===H});return{all:n,wins:n[0].values.filter(function(t){return t.wins}),stretches:s(n[0])};case"stretch-all":var r=D.map(s).filter(function(t){return t.length}).reduce(function(t,e){return t.concat(e)}),a=r.reduce(function(t,e){var n=[e[0],e[e.length-1]];return t.concat(n)},[]);return{all:[],wins:a,stretches:r};case"stretch-normalized":var o=D.map(s).filter(function(t){return t.length}).reduce(function(t,e){return t.concat(e)}),i=o.reduce(function(t,e){var n=[e[0],e[e.length-1]];return t.concat(n)},[]);return{all:[],wins:i,stretches:o};case"stretch-duration":var c=D.map(s).filter(function(t){return t.length}).reduce(function(t,e){return t.concat(e)}).map(function(t){return[t[0],t[t.length-1]]}).sort(function(t,e){return+t[0].seasonYear-+e[0].seasonYear}),u=c.reduce(function(t,e){return t.concat(e)},[]);return{all:[],wins:u,stretches:c};case"stretch-incomplete":var l=D.filter(function(t){return null!==t.incomplete}).map(function(t){return[t.values[t.incomplete],t.values[t.values.length-1]]}).sort(function(t,e){return+t[0].seasonYear-+e[0].seasonYear}),d=l.map(function(t){return t[0]});return{all:[],wins:d,stretches:l};default:return{}}}function u(){return"0,"+this.getTotalLength()}function l(){var t=this.getTotalLength(),e=d3.interpolateString("0,"+t,t+", "+t);return function(t){return e(t)}}function d(t){var e=t.length;document.querySelector(".madlib-count").innerHTML=e?"have completed the journey from the bottom to the top <strong class='top'>"+b[e]+"</strong> time"+(1===e?"":"s")+" in franchise history.":"have never completed a journey to the top after starting from the bottom.";var n=e?t[e-1].length-1:0;document.querySelector(".madlib-detail").innerHTML=e?"Their most recent ascent "+i(n)+" league average, spanning "+n+" seasons.":"Maybe next year fellas..."}function p(){d3.selectAll(".annotation").transition().duration(M).ease("elastic").style("opacity",0)}function f(e){W=e-R,R=e;var n=G.select(".chart"),r=n.select(".all-group"),a=n.select(".wins-group"),o=n.select(".stretch-group"),s=c(S[e]),i=r.selectAll(".all").data(s.all,function(t,e){return t.key?t.key+"-"+e:e}),f=a.selectAll(".wins").data(s.wins,function(t){return t.id}),h=o.selectAll(".stretch").data(s.stretches,function(t,e){return t.length?""+t[0].id:e});switch(p(),S[e]){case"top-and-bottom":f.enter().append("circle").attr("class",function(t){return"wins "+(t.bottom?"bottom":"")+" "+(t.top?"top":"")}).attr("r",0).attr("cx",function(t){return _(t.seasonFormatted)}).attr("cy",function(t){return Q(t.rank)}),f.transition().duration(M).delay(function(t){return 50*t.rank+(0===W?0:q)}).ease("quad-in-out").attr("r",E).attr("cx",function(t){return _(t.seasonFormatted)}).attr("cy",function(t){return Q(t.rank)});break;case"warriors":i.enter().append("path").attr("class","all").style("opacity",0),i.attr("d",function(t){return et(t.values)}).transition("quad-in-out").delay(q).duration(M).style("opacity",1),f.enter().append("circle").attr("class",function(t){return"wins "+(t.bottom?"bottom":"")+" "+(t.top?"top":"")}).attr("r",0).attr("cx",function(t){return _(t.seasonFormatted)}).attr("cy",function(t){return Q(t.rank)}),f.transition().delay(function(t,e){return 1.5*q+50*e}).duration(M*T).ease("elastic").attr("r",function(t){return t.bottom||t.top?I:E}).attr("cx",function(t){return _(t.seasonFormatted)}).attr("cy",function(t){return Q(t.rank)}),d3.select(".annotation-73").transition().delay(q).duration(M).ease("elastic").style("opacity",1);break;case"stretch-single":i.enter().append("path").attr("class","all"),i.attr("d",function(t){return et(t.values)}),h.enter().append("g").attr("class","stretch").append("path").attr("class","stretch-path").attr("stroke-width",E+"px"),h.select("path").attr("d",et).attr("stroke-dasharray",u),h.select("path").attr("d",et).transition().duration(M*T).ease("quad-in-out").attr("stroke-width",E+"px").attrTween("stroke-dasharray",l),f.enter().append("circle").attr("class",function(t){return"wins "+(t.bottom?"bottom":"")+" "+(t.top?"top":"")}).attr("r",0).attr("cx",function(t){return _(t.seasonFormatted)}).attr("cy",function(t){return Q(t.rank)}).attr("cy",function(t){return Q(t.rank)}),f.transition().duration(M).ease("elastic").attr("r",function(t){return t.bottom||t.top?I:E}),s.stretches.length&&!J&&(J=!0,F.play()),d(s.stretches);break;case"stretch-all":h.enter().append("g").attr("class","stretch").attr("transform",t(0,0)).style("opacity",0).append("path").attr("class","stretch-path").attr("stroke-width","2px"),h.transition().delay(q).duration(M).ease("quad-in-out").attr("transform",t(0,0)).style("opacity",1).select("path").transition().delay(q).duration(M).ease("quad-in-out").attr("stroke-width","2px").attr("d",et),f.enter().append("circle").attr("class",function(t){return"wins "+(t.bottom?"bottom":"")+" "+(t.top?"top":"")}).attr("r",0).attr("cx",function(t){return _(t.seasonFormatted)}).attr("cy",function(t){return Q(t.rank)}),f.transition().delay(q).duration(M).ease("quad-in-out").attr("r",E).attr("cx",function(t){return _(t.seasonFormatted)}).attr("cy",function(t){return Q(t.rank)}),d3.selectAll(".axis--y").transition().delay(q).duration(M).style("opacity",1);break;case"stretch-duration":h.enter().append("g").attr("class","stretch").attr("transform",function(e,n){return t(0,$(n))}).style("opacity",0).append("path").attr("class","stretch-path").attr("stroke-width","2px"),h.transition().delay(q).duration(M).ease("quad-in-out").attr("transform",function(e,n){return t(0,$(n))}).style("opacity",1).select("path").transition().delay(q).duration(M).ease("quad-in-out").attr("stroke-width","2px").attr("d",nt),f.enter().append("circle").attr("class",function(t){return"wins "+(t.bottom?"bottom":"")+" "+(t.top?"top":"")}).attr("r",0).attr("cx",function(t){return _(t.seasonFormatted)}).attr("cy",function(t,e){return $(Math.floor(e/2))}),f.transition().delay(q).duration(M).ease("quad-in-out").attr("r",E).attr("cx",function(t){return _(t.seasonFormatted)}).attr("cy",function(t,e){return $(Math.floor(e/2))}),d3.selectAll(".axis--y").transition().delay(q).duration(M).style("opacity",0),d3.select(".annotation-paul").transition().delay(q).duration(M).ease("elastic").style("opacity",1),d3.select(".annotation-spurs").transition().delay(q).duration(M).ease("elastic").style("opacity",1);break;case"stretch-incomplete":h.enter().append("g").attr("class","stretch").attr("transform",function(e,n){return t(0,$(n))}).style("opacity",0).append("path").attr("class","stretch-path").attr("stroke-width","2px"),h.transition().delay(q).duration(M).ease("quad-in-out").attr("transform",function(e,n){return t(0,$(n))}).style("opacity",1).select("path").transition().delay(q).duration(M).ease("quad-in-out").attr("stroke-width","2px").attr("d",nt),f.enter().append("circle").attr("class",function(t){return"wins "+(t.bottom?"bottom":"")+" "+(t.top?"top":"")}).attr("r",0).attr("cx",function(t){return _(t.seasonFormatted)}).attr("cy",function(t,e){return $(e)}),f.transition().delay(q).duration(M).ease("quad-in-out").attr("r",E).attr("cx",function(t){return _(t.seasonFormatted)}).attr("cy",function(t,e){return $(e)}),d3.selectAll(".axis--y").transition().delay(q).duration(M).style("opacity",0);break;default:return{}}i.exit().transition().duration(0===W?0:q).style("opacity",0).remove(),f.exit().transition().duration(0===W?0:q).attr("r",0).remove(),h.exit().transition().duration(0===W?0:q).style("opacity",0).remove()}function h(){H=this.value,2===R&&f(2)}function m(){graphScroll().container(d3.select("#container")).graph(d3.select("#graphic")).sections(d3.selectAll("section")).on("active",f)}function y(s,i){z=e(i);var c=d3.nest().key(function(t){return t.name}).entries(z);D=c.map(function(t){return n({},t,{values:o(t.values)})}).map(function(t){return n({},t,{stretches:a(t)})}).map(function(t){return n({},t,{incomplete:r(t.stretches.indices)})});var u=D.reduce(function(t,e){return t.concat(e.stretches.completed)},[]),l=D.reduce(function(t,e){return null!==e.incomplete?t+=1:t},0);U=d3.median(u),V=u.length,K=l,B=P-L.left-L.right,j=Y-L.top-L.bottom,G=d3.select("svg").attr("width",P).attr("height",Y);var d=G.append("g").attr("class","chart").attr("transform",t(L.left,L.top));_.domain(d3.extent(z,function(t){return t.seasonFormatted})).range([0,B]),Q.domain([1,z.filter(function(t){return"2015-16"===t.season}).length+1]).range([0,j]),X.domain([0,d3.max(u)]).range([0,B]),$.domain([0,V]).range([0,j]);var p=d3.svg.axis().scale(_).orient("bottom").tickFormat(d3.time.format("%Y")),f=d3.svg.axis().scale(Q).orient("left").tickValues([1,5,10,15,20,25,30]);d.append("g").attr("class","axis axis--x").attr("transform",t(0,j)).call(p),d.append("g").attr("class","axis axis--y").attr("transform",t(0,0)).call(f),d.append("g").attr("class","axis axis--y axis--y-label").attr("transform","rotate(-90)").append("text").text("Rank (regular season)").attr("x",-j/2).attr("y",0).attr("dy","-2em").style("text-anchor","middle"),d.append("g").attr("class","all-group"),d.append("g").attr("class","stretch-group"),d.append("g").attr("class","wins-group"),m(),g(),v()}function g(){var t=document.querySelector(".madlib-name"),e=Object.keys(k).map(function(t){var e="GSW"===t?" selected":"";return"<option"+e+" value='"+t+"'>"+k[t]+"</option>"}).join("\n");t.innerHTML=e,t.addEventListener("change",h);var n=D.filter(function(t){return"GSW"===t.key});d(s(n[0])),document.querySelector(".madlib-total").textContent=V,document.querySelector(".madlib-median").textContent=U}function v(){d3.select(".chart").append("marker").attr("id","arrow").attr("viewBox","-10 -10 20 20").attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("path").attr("d","M-6.75,-6.75 L 0,0 L -6.75,6.75"),window.annotationsRank=[{x:"1977",y:2,path:"M152,10C96,-17,50,-16,16,-5",text:"Paul Pierce is born",className:"annotation annotation-paul",textOffset:[155,17]},{x:"2016",y:1,path:"M-113,55C-62,55,-21,45,0,9",text:"73 wins!",className:"annotation annotation-73",textOffset:[-160,58]}],window.annotationsOrder=[{x:"1997",y:27,path:"M-31,35C-13,36,9,28,9,0",text:"The Spurs get right back up",className:"annotation annotation-spurs",textOffset:[-173,38]}];var t=d3.swoopyDrag().x(function(t){return _(tt.parse(t.x))}).y(function(t){return Q(t.y)}).draggable(C).annotations(annotationsRank).className(function(t){return t.className}),e=d3.select(".chart").append("g").attr("class","annotations").call(t);e.selectAll("path").attr("marker-end","url(#arrow)");var n=d3.swoopyDrag().x(function(t){return _(tt.parse(t.x))}).y(function(t){return $(t.y)}).draggable(C).annotations(annotationsOrder).className(function(t){return t.className}),r=d3.select(".chart").append("g").attr("class","annotations").call(n);r.selectAll("path").attr("marker-end","url(#arrow)")}function x(){var t=document.createElement("script");t.src="https://www.youtube.com/iframe_api";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e);var n=null,r=!1,a=function(){console.log("setup steph");var t=document.querySelector(".stephen-curry"),e=document.querySelector(".youtube");t.addEventListener("mouseenter",function(t){e.classList.remove("transparent"),n.playVideo()}),t.addEventListener("mouseout",function(t){e.classList.add("transparent"),n.pauseVideo()})},o=function(t){console.log("player ready",t),n.mute(),n.playVideo()},s=function(t){console.log("player statechange",t),r||1!==t.data||(r=!0,n.pauseVideo(),n.unMute(),n.setVolume(50),a())};window.onYouTubeIframeAPIReady=function(){n=new YT.Player("player",{height:"100%",width:"100%",videoId:"tvN-EYgYSZI",events:{onReady:o,onStateChange:s}})}}function w(){var t=document.getElementById("container").offsetWidth;P=t-O-A,Y=Math.round(window.innerHeight-2*A),E=Math.max(4,Math.round(Y/200)),I=Math.round(E*N),d3.json("data/output.json",y),x()}var k={ATL:"Hawks",BOS:"Celtics",BRK:"Nets",CHI:"Bulls",CHO:"Hornets",CLE:"Cavaliers",DAL:"Mavericks",DEN:"Nuggets",DET:"Pistons",GSW:"Warriors",HOU:"Rockets",IND:"Pacers",LAC:"Clippers",LAL:"Lakers",MEM:"Grizzlies",MIA:"Heat",MIL:"Bucks",MIN:"Timberwolves",NOP:"Pelicans",NYK:"Knicks",OKC:"Thunder",ORL:"Magic",PHI:"76ers",PHO:"Suns",POR:"Trail Blazers",SAC:"Kings",SAS:"Spurs",TOR:"Raports",UTA:"Jazz",WAS:"Wizards"},b=["zero","one","two","three","four","five"],S=["top-and-bottom","warriors","stretch-single","stretch-all","stretch-duration","stretch-incomplete"],M=1e3,q=M,L={top:20,right:40,bottom:40,left:40},A=20,O=360,T=2.8,N=1.5,C=!1,F=document.querySelector(".sample"),H="GSW",P=0,Y=0,E=0,I=0,R=0,W=0,B=0,j=0,z=[],D=[],G=null,V=0,K=0,U=0,J=!1,Z="step",_=d3.time.scale(),Q=d3.scale.linear(),X=d3.scale.linear(),$=d3.scale.linear(),tt=d3.time.format("%Y"),et=d3.svg.line().defined(function(t){return t.rank}).interpolate(Z).x(function(t){return _(t.seasonFormatted)}).y(function(t){return Q(t.rank)}),nt=(d3.svg.line().defined(function(t){return t.rank}).interpolate(Z).x(function(t,e){return X(e)}).y(function(t){return Q(t.rank)}),d3.svg.line().defined(function(t){return t.rank}).interpolate("linear").x(function(t){return _(t.seasonFormatted)}).y(function(t){return 0}));w()}()}]);